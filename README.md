# OpenCV機械学習画像認識プロジェクト

このプロジェクトは、OpenCVと機械学習を使用した画像認識システムを提供します。顔検出、物体検出、画像分類の機能が含まれており、**Webアプリ版**も利用できます。

## 🌐 Webアプリ版（推奨）

ブラウザから簡単に画像処理機能を利用できるWebアプリケーションを提供しています。

### 🚀 Webアプリの起動方法

```bash
# プロジェクトディレクトリに移動
cd /home/opencv-ml-project/webapp

# Webアプリを起動
python3 run_webapp.py
```

### 🔗 アクセスリンク

起動後、ブラウザで以下のURLにアクセスしてください：

- **メインページ**: http://localhost:5000
- **デモページ**: http://localhost:5000/demo
- **技術詳細**: http://localhost:5000/features

### ✨ Webアプリの機能

- **📁 画像アップロード**: ドラッグ&ドロップまたはクリックで選択
- **👤 顔検出**: 人物写真の顔と目を自動検出
- **🔍 物体検出**: 図形や物体の形状を識別・分類
- **📐 エッジ検出**: 画像の境界線を抽出
- **🎯 デモ機能**: サンプル画像で即座にテスト可能
- **📱 レスポンシブ対応**: PC・スマホ・タブレットで利用可能

### 🛑 Webアプリの停止方法

```bash
# ターミナルで Ctrl+C を押す
```

## プロジェクト構成

```
opencv-ml-project/
├── requirements.txt          # 依存関係
├── face_detection.py         # 顔検出システム
├── object_detection.py       # 物体検出システム
├── image_classification.py   # 画像分類システム
└── README.md                # このファイル
```

## セットアップ

### 1. 仮想環境の作成とアクティベート

```bash
cd opencv-ml-project
python3 -m venv venv
source venv/bin/activate
```

### 2. 依存関係のインストール

```bash
pip install -r requirements.txt
```

### 3. セットアップテストの実行

```bash
python run_example.py
```

### 2. 必要なライブラリ

- OpenCV (opencv-python)
- NumPy
- scikit-learn
- matplotlib
- Pillow
- TensorFlow/Keras

## 使用方法

**重要:** 必ず仮想環境をアクティベートしてから実行してください：
```bash
source venv/bin/activate
```

### デモテスト (demo_test.py)

すべての機能をテストし、動作確認を行います。

```bash
python demo_test.py
```

### 顔検出システム (face_detection.py)

顔と目の検出を行うシステムです。

```bash
python face_detection.py
```

**機能:**
- 静止画像からの顔検出
- ウェブカメラからのリアルタイム顔検出
- 検出された顔と目に矩形を描画

**使用例:**
1. プログラムを実行
2. 「1」を選択して画像ファイルから顔検出
3. 「2」を選択してウェブカメラからリアルタイム検出

### 物体検出システム (object_detection.py)

様々な物体検出手法を提供します。

```bash
python object_detection.py
```

**機能:**
- 静止画像からの物体検出（輪郭ベース）
- ウェブカメラからの動体検出
- エッジ検出と形状認識

**使用例:**
1. プログラムを実行
2. 「1」を選択して画像から物体検出
3. 「2」を選択して動体検出
4. 「3」を選択してエッジ検出と形状認識

### 画像分類システム (image_classification.py)

機械学習を使用した画像分類システムです。

```bash
python image_classification.py
```

**機能:**
- HOG特徴量 + 色ヒストグラム + LBP特徴量を使用
- Random ForestまたはSVMモデル
- カスタムデータセットでの訓練
- モデルの保存と読み込み

**使用例:**
1. プログラムを実行
2. 「1」を選択してサンプルデータセットを作成
3. 「2」を選択してモデルを訓練
4. 「3」を選択して画像を分類

## 特徴量抽出手法

### HOG (Histogram of Oriented Gradients)
- 画像の勾配方向のヒストグラムを計算
- 物体の形状を効果的に捉える

### 色ヒストグラム
- RGBチャンネルの色分布を計算
- 色情報を特徴量として使用

### LBP (Local Binary Pattern)
- 局所的なテクスチャパターンを抽出
- テクスチャの特徴を効果的に捉える

## データセット構造

画像分類システムで使用するデータセットは以下の構造で配置してください：

```
dataset/
├── class1/
│   ├── image1.jpg
│   ├── image2.jpg
│   └── ...
├── class2/
│   ├── image1.jpg
│   ├── image2.jpg
│   └── ...
└── ...
```

## サンプルデータセット

画像分類システムには、円、四角、三角形の幾何学図形を自動生成するサンプルデータセット作成機能があります。

## トラブルシューティング

### ウェブカメラが認識されない場合
- カメラのアクセス許可を確認
- 他のアプリケーションがカメラを使用していないか確認
- `cv2.VideoCapture(0)`の引数を変更（1, 2など）

### 画像が読み込めない場合
- ファイルパスが正しいか確認
- 画像形式がサポートされているか確認（PNG, JPG, JPEG）
- ファイルの権限を確認

### モデルの精度が低い場合
- より多くのデータを用意
- 特徴量の種類を増やす
- モデルのハイパーパラメータを調整
- データの前処理を改善

## 拡張可能性

このプロジェクトは以下のように拡張できます：

1. **深層学習モデルの追加**
   - CNNベースの分類器
   - 転移学習の実装

2. **より高度な物体検出**
   - YOLO、SSDなどの最新手法
   - 事前学習済みモデルの使用

3. **リアルタイム処理の最適化**
   - マルチスレッド処理
   - GPU加速

4. **新しい特徴量の追加**
   - SIFT、SURF
   - 深層学習特徴量

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 注意事項

- ウェブカメラを使用する機能は、プライバシーに配慮して使用してください
- 商用利用の場合は、使用する画像データの著作権を確認してください
- 機械学習モデルの性能は、訓練データの品質と量に依存します